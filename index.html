<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>陆英杰的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="陆英杰的博客" content="陆英杰的博客" />
    <link rel="stylesheet" type="text/css" href="#{cssPath}/github.css" />
    <link rel="stylesheet" type="text/css" href="#{cssPath}/highlight.css" />
    <link
      rel="stylesheet"
      href="https://at.alicdn.com/t/font_1374216_3j8f2tz0cxn.css"
    />
  </head>
  <body>
    <!-- 回到顶部的按钮 -->
    <a class="top" href="#header">
      <img
        src="https://g.csdnimg.cn/side-toolbar/1.4/images/fanhuidingbucopy.png"
        alt=""
      />
    </a>
    <div id="header"></div>
    <div id="sidebar">
      <div class="top-buttons">
        <a
          href="javascript:void;"
          id="top-buttons-file"
          onclick="changeTopButton('file')"
          class="top-buttons-ele toc-buttons-file top-clicked"
          >文件</a
        >
        <a
          href="javascript:void;"
          id="top-buttons-toc"
          onclick="changeTopButton('toc')"
          class="top-buttons-ele top-buttons-toc"
          >目录</a
        >
      </div>
      <!-- 侧边栏的大纲 -->
      <div id="top-content" class="top-content" style="display:none">
        #{treeHtml}
      </div>
      <!-- 侧边栏的目录 -->
      <div id="top-file" class="top-file">#{topFile}</div>
    </div>

    <div class="top-container">
      <h1>我是空白区</h1>
    </div>
  </body>
</html>

<script>
  let fileTitle;
  let fileContent;
  let tocTitle;
  let tocContent;
  let folderList;

  window.onload = function() {
    fileTitle = document.querySelector("#top-buttons-file");
    fileContent = document.querySelector("#top-file");
    tocTitle = document.querySelector("#top-buttons-toc");
    tocContent = document.querySelector("#top-content");

    //为所有目录添加监听器
    folderList = document.querySelectorAll(".folder");
    folderList.forEach(ele => ele.addEventListener("click", folderClick));

    //initialize
    //全部文件夹是打开的,则设置箭头向下
    document.querySelectorAll(".icon-right").forEach(ele => {
      ele.style.display = "none";
    });

    // folderList.forEach(elm => {
    //   folderClick.call(elm);
    // });
  };

  function changeTopButton(type) {
    if (type === "file") {
      //显示与隐藏
      fileTitle.classList.add("top-clicked");
      tocTitle.classList.remove("top-clicked");

      fileContent.style.display = "block";
      tocContent.style.display = "none";
    } else if (type === "toc") {
      fileTitle.classList.remove("top-clicked");
      tocTitle.classList.add("top-clicked");

      fileContent.style.display = "none";
      tocContent.style.display = "block";
    }
  }

  function folderClick() {
    //子级的隐藏和显示
    let display = this.parentElement.nextElementSibling.style.display;
    this.parentElement.nextElementSibling.style.display =
      display === "block" || display === "" ? "none" : "block";

    //文件夹箭头的变动
    var down = this.querySelector(".icon-down");
    var right = this.querySelector(".icon-right");
    if (down != null && right != null) {
      down.style.display =
        down.style.display === "block" || down.style.display === ""
          ? "none"
          : "block";

      right.style.display =
        right.style.display === "block" || down.style.display === ""
          ? "none"
          : "block";
    }
  }
</script>
